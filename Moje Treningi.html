<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-align=1.0">
    <title>Moje Treningi</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Icons
        const Dumbbell = () => (
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <path d="M6.5 6.5L17.5 17.5"></path>
                <path d="M6.5 17.5L17.5 6.5"></path>
                <circle cx="6.5" cy="6.5" r="2"></circle>
                <circle cx="17.5" cy="17.5" r="2"></circle>
                <circle cx="17.5" cy="6.5" r="2"></circle>
                <circle cx="6.5" cy="17.5" r="2"></circle>
            </svg>
        );

        const Trash2 = () => (
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
            </svg>
        );

        const WorkoutTracker = () => {
            const [workouts, setWorkouts] = useState([]);
            const [currentMonth, setCurrentMonth] = useState(new Date().getMonth());
            const [currentYear, setCurrentYear] = useState(new Date().getFullYear());
            const [initialized, setInitialized] = useState(false);
            const [selectedDay, setSelectedDay] = useState(null);
            const [showMenu, setShowMenu] = useState(false);
            const [menuPosition, setMenuPosition] = useState({ x: 0, y: 0 });

            const monthNames = ['Stycze≈Ñ', 'Luty', 'Marzec', 'Kwiecie≈Ñ', 'Maj', 'Czerwiec', 
                               'Lipiec', 'Sierpie≈Ñ', 'Wrzesie≈Ñ', 'Pa≈∫dziernik', 'Listopad', 'Grudzie≈Ñ'];
            const dayNames = ['Pon', 'Wt', '≈ör', 'Czw', 'Pt', 'Sob', 'Ndz'];

            useEffect(() => {
                const saved = localStorage.getItem('workouts');
                
                if (saved) {
                    setWorkouts(JSON.parse(saved));
                } else {
                    const initialWorkout = {
                        id: Date.now(),
                        date: '2026-02-03',
                        type: 'Pull',
                        timestamp: new Date('2026-02-03').toISOString()
                    };
                    setWorkouts([initialWorkout]);
                }
                setInitialized(true);
            }, []);

            useEffect(() => {
                localStorage.setItem('workouts', JSON.stringify(workouts));
            }, [workouts]);

            // Close menu when clicking outside
            useEffect(() => {
                const handleClickOutside = () => {
                    if (showMenu) {
                        setShowMenu(false);
                        setSelectedDay(null);
                    }
                };
                
                document.addEventListener('click', handleClickOutside);
                return () => document.removeEventListener('click', handleClickOutside);
            }, [showMenu]);

            const getDateString = (date) => {
                return `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
            };

            const addWorkout = (date, type) => {
                const dateStr = getDateString(date);
                const existing = workouts.find(w => w.date === dateStr);
                
                if (existing) {
                    setWorkouts(workouts.map(w => 
                        w.date === dateStr ? { ...w, type } : w
                    ));
                } else {
                    setWorkouts([...workouts, {
                        id: Date.now(),
                        date: dateStr,
                        type: type,
                        timestamp: new Date().toISOString()
                    }]);
                }
            };

            const removeWorkout = (dateStr) => {
                setWorkouts(workouts.filter(w => w.date !== dateStr));
            };

            const getWorkoutForDate = (date) => {
                const dateStr = getDateString(date);
                return workouts.find(w => w.date === dateStr);
            };

            const handleDayClick = (day, event) => {
                event.stopPropagation();
                const date = new Date(currentYear, currentMonth, day);
                setSelectedDay(date);
                
                const rect = event.currentTarget.getBoundingClientRect();
                setMenuPosition({
                    x: rect.left + rect.width / 2,
                    y: rect.top - 10
                });
                
                setShowMenu(true);
            };

            const handleWorkoutSelect = (type, event) => {
                event.stopPropagation();
                if (selectedDay) {
                    addWorkout(selectedDay, type);
                }
                setShowMenu(false);
                setSelectedDay(null);
            };

            const handleDeleteWorkout = (event) => {
                event.stopPropagation();
                if (selectedDay) {
                    const dateStr = getDateString(selectedDay);
                    removeWorkout(dateStr);
                }
                setShowMenu(false);
                setSelectedDay(null);
            };

            // Calculate yearly workout count
            const getYearlyWorkoutCount = () => {
                return workouts.filter(w => {
                    const workoutDate = new Date(w.date);
                    return workoutDate.getFullYear() === currentYear && 
                           (w.type === 'Push' || w.type === 'Pull');
                }).length;
            };

            const getPlannedWorkout = (date) => {
                const dateStr = getDateString(date);
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                const checkDate = new Date(date);
                checkDate.setHours(0, 0, 0, 0);
                
                if (checkDate < today) {
                    return null;
                }
                
                if (getWorkoutForDate(date)) {
                    return null;
                }
                
                const sortedWorkouts = [...workouts]
                    .filter(w => new Date(w.date) <= checkDate)
                    .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());
                
                if (sortedWorkouts.length === 0) return null;
                
                const lastWorkout = new Date(sortedWorkouts[0].date);
                lastWorkout.setHours(0, 0, 0, 0);
                
                const daysSince = Math.floor((checkDate.getTime() - lastWorkout.getTime()) / (1000 * 60 * 60 * 24));
                
                if (daysSince === 1) {
                    return 'REST';
                }
                
                if (daysSince === 2) {
                    return sortedWorkouts[0].type === 'Push' ? 'Pull' : 'Push';
                }
                
                return null;
            };

            const getMonthStats = () => {
                const monthWorkouts = workouts.filter(w => {
                    const date = new Date(w.date);
                    return date.getMonth() === currentMonth && date.getFullYear() === currentYear;
                });

                const pushCount = monthWorkouts.filter(w => w.type === 'Push').length;
                const pullCount = monthWorkouts.filter(w => w.type === 'Pull').length;
                const restCount = monthWorkouts.filter(w => w.type === 'REST').length;
                const totalWorkouts = pushCount + pullCount;

                return { pushCount, pullCount, restCount, totalWorkouts };
            };

            const getCurrentStreak = () => {
                const today = new Date();
                today.setHours(0, 0, 0, 0);
                
                const sortedWorkouts = [...workouts]
                    .filter(w => w.type !== 'REST')
                    .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime());

                if (sortedWorkouts.length === 0) return 0;

                let streak = 0;
                let currentDate = new Date(today);
                
                for (let workout of sortedWorkouts) {
                    const workoutDate = new Date(workout.date);
                    workoutDate.setHours(0, 0, 0, 0);
                    
                    const expectedDate = new Date(currentDate);
                    expectedDate.setDate(expectedDate.getDate() - (streak * 2 + (streak > 0 ? 1 : 0)));
                    expectedDate.setHours(0, 0, 0, 0);
                    
                    if (streak === 0) {
                        const diff = Math.floor((currentDate.getTime() - workoutDate.getTime()) / (1000 * 60 * 60 * 24));
                        if (diff <= 2) {
                            streak = 1;
                            currentDate = new Date(workoutDate);
                        } else {
                            break;
                        }
                    } else {
                        const diff = Math.floor((currentDate.getTime() - workoutDate.getTime()) / (1000 * 60 * 60 * 24));
                        if (diff >= 1 && diff <= 2) {
                            streak++;
                            currentDate = new Date(workoutDate);
                        } else {
                            break;
                        }
                    }
                }
                
                return streak;
            };

            const getDaysInMonth = (month, year) => {
                return new Date(year, month + 1, 0).getDate();
            };

            const getFirstDayOfMonth = (month, year) => {
                const day = new Date(year, month, 1).getDay();
                return day === 0 ? 6 : day - 1;
            };

            const getCalendarDays = () => {
                const daysInMonth = getDaysInMonth(currentMonth, currentYear);
                const firstDay = getFirstDayOfMonth(currentMonth, currentYear);
                
                const days = [];
                for (let i = 0; i < firstDay; i++) {
                    days.push(null);
                }
                for (let i = 1; i <= daysInMonth; i++) {
                    days.push(i);
                }
                return days;
            };

            const changeMonth = (delta) => {
                let newMonth = currentMonth + delta;
                let newYear = currentYear;
                
                if (newMonth > 11) {
                    newMonth = 0;
                    newYear++;
                } else if (newMonth < 0) {
                    newMonth = 11;
                    newYear--;
                }
                
                setCurrentMonth(newMonth);
                setCurrentYear(newYear);
            };

            const isToday = (day) => {
                const today = new Date();
                return day === today.getDate() && 
                       currentMonth === today.getMonth() && 
                       currentYear === today.getFullYear();
            };

            const stats = getMonthStats();
            const streak = getCurrentStreak();
            const yearlyCount = getYearlyWorkoutCount();

            if (!initialized) {
                return (
                    <div className="min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 flex items-center justify-center">
                        <div className="text-2xl text-slate-600">≈Åadowanie...</div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-50 via-blue-50 to-slate-100 p-4">
                    <div className="max-w-6xl mx-auto">
                        <div className="text-center mb-8 pt-6">
                            <div className="flex items-center justify-center gap-3 mb-2">
                                <div className="text-blue-600">
                                    <Dumbbell />
                                </div>
                                <h1 className="text-5xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
                                    Moje Treningi
                                </h1>
                                <div className="text-blue-600">
                                    <Dumbbell />
                                </div>
                            </div>
                            <p className="text-slate-600 text-lg">≈öled≈∫ swoje postƒôpy! üí™</p>
                        </div>

                        <div className="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                            <div className="bg-gradient-to-br from-emerald-500 to-emerald-600 rounded-2xl shadow-xl p-6 text-white transform hover:scale-105 transition-transform">
                                <div className="text-emerald-100 text-sm font-semibold mb-1">TRENINGI W ROKU {currentYear}</div>
                                <div className="text-5xl font-bold">{yearlyCount}</div>
                                <div className="text-emerald-100 text-sm mt-2">Tak trzymaj! üéØ</div>
                            </div>

                            <div className="bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl shadow-xl p-6 text-white transform hover:scale-105 transition-transform">
                                <div className="text-blue-100 text-sm font-semibold mb-1">TRENINGI W MIESIƒÑCU</div>
                                <div className="text-5xl font-bold">{stats.totalWorkouts}</div>
                                <div className="text-blue-100 text-sm mt-2">
                                    Push: {stats.pushCount} | Pull: {stats.pullCount}
                                </div>
                            </div>

                            <div className="bg-gradient-to-br from-purple-500 to-purple-600 rounded-2xl shadow-xl p-6 text-white transform hover:scale-105 transition-transform">
                                <div className="text-purple-100 text-sm font-semibold mb-1">AKTUALNA SERIA</div>
                                <div className="text-5xl font-bold">{streak}</div>
                                <div className="text-purple-100 text-sm mt-2">
                                    {streak > 0 ? 'üî• Niesamowite!' : 'Czas zaczƒÖƒá!'}
                                </div>
                            </div>
                        </div>

                        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <div className="lg:col-span-2 bg-white rounded-2xl shadow-xl p-6">
                                <div className="flex justify-between items-center mb-6">
                                    <button
                                        onClick={() => changeMonth(-1)}
                                        className="px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg font-semibold text-slate-700 transition-colors"
                                    >
                                        ‚Üê Poprzedni
                                    </button>
                                    <h2 className="text-2xl font-bold text-slate-800">
                                        {monthNames[currentMonth]} {currentYear}
                                    </h2>
                                    <button
                                        onClick={() => changeMonth(1)}
                                        className="px-4 py-2 bg-slate-100 hover:bg-slate-200 rounded-lg font-semibold text-slate-700 transition-colors"
                                    >
                                        Nastƒôpny ‚Üí
                                    </button>
                                </div>

                                <div className="grid grid-cols-7 gap-2 mb-2">
                                    {dayNames.map(day => (
                                        <div key={day} className="text-center text-sm font-semibold text-slate-600 p-2">
                                            {day}
                                        </div>
                                    ))}
                                </div>

                                <div className="grid grid-cols-7 gap-2">
                                    {getCalendarDays().map((day, index) => {
                                        if (day === null) {
                                            return <div key={`empty-${index}`} className="aspect-square"></div>;
                                        }

                                        const date = new Date(currentYear, currentMonth, day);
                                        const workout = getWorkoutForDate(date);
                                        const planned = getPlannedWorkout(date);
                                        const today = isToday(day);

                                        let bgClass = 'bg-white hover:bg-slate-50 text-slate-700 border-2 border-slate-200';
                                        
                                        if (workout) {
                                            if (workout.type === 'Push') {
                                                bgClass = 'bg-gradient-to-br from-green-400 via-green-500 to-green-600 text-white font-bold shadow-lg border-2 border-green-600 hover:shadow-xl';
                                            } else if (workout.type === 'Pull') {
                                                bgClass = 'bg-gradient-to-br from-amber-400 via-amber-500 to-orange-500 text-white font-bold shadow-lg border-2 border-orange-600 hover:shadow-xl';
                                            } else if (workout.type === 'REST') {
                                                bgClass = 'bg-gradient-to-br from-sky-400 via-blue-500 to-blue-600 text-white font-bold shadow-lg border-2 border-blue-600 hover:shadow-xl';
                                            }
                                        } else if (planned) {
                                            if (planned === 'REST') {
                                                bgClass = 'bg-gradient-to-br from-sky-100 to-sky-200 border-2 border-sky-400 border-dashed text-sky-700 font-semibold';
                                            } else if (planned === 'Push') {
                                                bgClass = 'bg-gradient-to-br from-green-50 to-green-100 border-2 border-green-400 border-dashed text-green-700 font-semibold';
                                            } else {
                                                bgClass = 'bg-gradient-to-br from-amber-50 to-amber-100 border-2 border-amber-400 border-dashed text-amber-700 font-semibold';
                                            }
                                        }

                                        return (
                                            <button
                                                key={day}
                                                onClick={(e) => handleDayClick(day, e)}
                                                className={`aspect-square rounded-xl p-2 transition-all hover:scale-105 ${
                                                    today ? 'ring-4 ring-purple-500 ring-offset-2' : ''
                                                } ${bgClass}`}
                                            >
                                                <div className="text-lg font-bold">{day}</div>
                                                {workout && (
                                                    <div className="text-xs mt-1">
                                                        {workout.type === 'REST' ? 'üò¥' : workout.type === 'Push' ? 'üí™' : 'üèãÔ∏è'}
                                                    </div>
                                                )}
                                                {!workout && planned && (
                                                    <div className="text-xs mt-1">{planned === 'REST' ? 'üò¥?' : `${planned}?`}</div>
                                                )}
                                            </button>
                                        );
                                    })}
                                </div>

                                <div className="mt-6 p-4 bg-gradient-to-r from-slate-50 to-blue-50 rounded-xl border-2 border-slate-200">
                                    <p className="text-sm text-slate-700 font-semibold mb-3">
                                        üìå Legenda:
                                    </p>
                                    <div className="grid grid-cols-2 gap-3">
                                        <div className="flex items-center gap-2">
                                            <div className="w-8 h-8 rounded-lg bg-gradient-to-br from-green-400 to-green-600 shadow-md border-2 border-green-600"></div>
                                            <span className="text-sm font-medium">üí™ Push</span>
                                        </div>
                                        <div className="flex items-center gap-2">
                                            <div className="w-8 h-8 rounded-lg bg-gradient-to-br from-amber-400 to-orange-500 shadow-md border-2 border-orange-600"></div>
                                            <span className="text-sm font-medium">üèãÔ∏è Pull</span>
                                        </div>
                                        <div className="flex items-center gap-2">
                                            <div className="w-8 h-8 rounded-lg bg-gradient-to-br from-sky-400 to-blue-600 shadow-md border-2 border-blue-600"></div>
                                            <span className="text-sm font-medium">üò¥ REST</span>
                                        </div>
                                        <div className="flex items-center gap-2">
                                            <div className="w-8 h-8 rounded-lg bg-white ring-4 ring-purple-500 ring-offset-2 border-2 border-slate-200"></div>
                                            <span className="text-sm font-medium">Dzisiaj</span>
                                        </div>
                                    </div>
                                    <p className="text-xs text-slate-500 mt-3 italic">
                                        üí° Kliknij na dzie≈Ñ aby wybraƒá typ treningu
                                    </p>
                                </div>
                            </div>

                            <div className="bg-white rounded-2xl shadow-xl p-6">
                                <h2 className="text-2xl font-bold text-slate-800 mb-4">üìã Ostatnie treningi</h2>
                                <div className="space-y-2 max-h-[600px] overflow-y-auto">
                                    {[...workouts]
                                        .sort((a, b) => new Date(b.date).getTime() - new Date(a.date).getTime())
                                        .slice(0, 20)
                                        .map(workout => {
                                            const date = new Date(workout.date);
                                            const dateStr = `${date.getDate()} ${monthNames[date.getMonth()]} ${date.getFullYear()}`;
                                            
                                            return (
                                                <div 
                                                    key={workout.id} 
                                                    className={`flex items-center justify-between p-3 rounded-xl border-2 ${
                                                        workout.type === 'Push' 
                                                            ? 'bg-gradient-to-r from-green-50 to-green-100 border-green-300' 
                                                            : workout.type === 'Pull'
                                                                ? 'bg-gradient-to-r from-amber-50 to-orange-100 border-orange-300'
                                                                : 'bg-gradient-to-r from-sky-50 to-blue-100 border-blue-300'
                                                    }`}
                                                >
                                                    <div className="flex items-center gap-3">
                                                        <span className={`px-3 py-1 rounded-full text-sm font-bold shadow-md ${
                                                            workout.type === 'Push'
                                                                ? 'bg-gradient-to-r from-green-500 to-green-600 text-white'
                                                                : workout.type === 'Pull'
                                                                    ? 'bg-gradient-to-r from-amber-500 to-orange-500 text-white'
                                                                    : 'bg-gradient-to-r from-sky-500 to-blue-600 text-white'
                                                        }`}>
                                                            {workout.type === 'REST' ? 'üò¥ REST' : workout.type === 'Push' ? 'üí™ Push' : 'üèãÔ∏è Pull'}
                                                        </span>
                                                        <span className="font-medium text-slate-700">{dateStr}</span>
                                                    </div>
                                                    <button
                                                        onClick={() => removeWorkout(workout.date)}
                                                        className="text-red-500 hover:text-red-700 hover:bg-red-100 p-2 rounded-lg transition-colors"
                                                    >
                                                        <Trash2 />
                                                    </button>
                                                </div>
                                            );
                                        })}
                                    {workouts.length === 0 && (
                                        <p className="text-slate-400 text-center py-8 italic">
                                            Jeszcze nie doda≈Çe≈õ ≈ºadnych trening√≥w. Kliknij na dzie≈Ñ w kalendarzu aby zaczƒÖƒá! üí™
                                        </p>
                                    )}
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Popup menu */}
                    {showMenu && selectedDay && (
                        <div 
                            className="fixed z-50"
                            style={{
                                left: `${menuPosition.x}px`,
                                top: `${menuPosition.y}px`,
                                transform: 'translate(-50%, -100%)'
                            }}
                            onClick={(e) => e.stopPropagation()}
                        >
                            <div className="bg-white rounded-2xl shadow-2xl border-4 border-slate-200 p-2 mb-2">
                                <div className="flex flex-col gap-2">
                                    <button
                                        onClick={(e) => handleWorkoutSelect('Push', e)}
                                        className="px-6 py-3 bg-gradient-to-r from-green-500 to-green-600 hover:from-green-600 hover:to-green-700 text-white font-bold rounded-xl transition-all hover:scale-105 shadow-md"
                                    >
                                        üí™ Push
                                    </button>
                                    <button
                                        onClick={(e) => handleWorkoutSelect('Pull', e)}
                                        className="px-6 py-3 bg-gradient-to-r from-amber-500 to-orange-500 hover:from-amber-600 hover:to-orange-600 text-white font-bold rounded-xl transition-all hover:scale-105 shadow-md"
                                    >
                                        üèãÔ∏è Pull
                                    </button>
                                    <button
                                        onClick={(e) => handleWorkoutSelect('REST', e)}
                                        className="px-6 py-3 bg-gradient-to-r from-sky-500 to-blue-600 hover:from-sky-600 hover:to-blue-700 text-white font-bold rounded-xl transition-all hover:scale-105 shadow-md"
                                    >
                                        üò¥ REST
                                    </button>
                                    {getWorkoutForDate(selectedDay) && (
                                        <button
                                            onClick={handleDeleteWorkout}
                                            className="px-6 py-3 bg-red-500 hover:bg-red-600 text-white font-bold rounded-xl transition-all hover:scale-105 shadow-md"
                                        >
                                            üóëÔ∏è Usu≈Ñ
                                        </button>
                                    )}
                                </div>
                            </div>
                            <div 
                                className="w-0 h-0 mx-auto"
                                style={{
                                    borderLeft: '10px solid transparent',
                                    borderRight: '10px solid transparent',
                                    borderTop: '10px solid #e2e8f0'
                                }}
                            ></div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<WorkoutTracker />);
    </script>
</body>
</html>